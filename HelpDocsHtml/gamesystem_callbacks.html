<html><head><link rel='stylesheet' href='../HelpDocs/help.css'><link href='https://fonts.googleapis.com/css?family=Roboto:300|Ubuntu:300' rel='stylesheet'></head><body><span class='button'><a href='home.html'>Home</a></span><span class='button'><a href='index.html'>Index</a></span><html><head><link rel='stylesheet' href='help.css'></head><body><h1>Game System Callbacks</h1><div class='section text'>The following functions are called by the system in response to various events.  These should never be called directly.  Most of these functions then pass control to other functions that are meant to be modified with game logic. For example:  The system callback <span class='inline_code'>_clickedAt()</span> calls <span class='inline_code'>clickedAt()</span> and any game logic should be placed there. <div class='line_break'></div> </div><div class='function_list'><div id='3' class='function'>_initRoom(room)<div class='desc'>Called only once when the room is inited.</div><div class='function text'>This function then calls room.init(). </div></div><div id='4' class='function'>_initObject(object)<div class='desc'>Called only once when the object is inited.</div><div class='function text'>This function then calls <span class='inline_code'>object.init()</span>.  It also sets up door verbs if <span class='inline_code'>object.door_verbs</span> is set and then registers all verbs found in the object. </div></div><div id='5' class='function'>_enterRoom(room, stage)<div class='desc'>Called when the room is entered.</div><div class='function text'>Based on the <span class='inline_code'>stage</span>, this function calls <span class='inline_code'>room.preEnter()</span>, <span class='inline_code'>room.enter()</span> and <span class='inline_code'>room.postEnter()</span>. </div></div><div id='6' class='function'>_exitRoom(room, stage)<div class='desc'>Called when exiting a room</div><div class='function text'>This function calls <span class='inline_code'>room.exit()</span>. </div></div><div id='7' class='function'>_enterObject(object)<div class='desc'>Called for each object when entering a room.</div><div class='function text'>Called after room.preEnter() but before room.enter() <div class='line_break'></div> If the object is a trigger and has trigger code, it is added and enabled. <div class='line_break'></div> Sounds defined with a <span class='inline_code'>object.sound</span> are started, after which <span class='inline_code'>object.enter()</span> is called. Then objects that have a <span class='inline_code'>state</span> variable are set to the last frame of that animation. <div class='line_break'></div> If the sound is a FMOD spatially aware, it won't be heard more than 500 pixels away (by default). The can be changed in FMOD. </div></div><div id='8' class='function'>_enterObject(object)<div class='desc'>Called for each actor when entering a room.</div><div class='function text'>This is also called when an actor is placed in the current room. </div></div><div id='9' class='function'>_exitObject(room, stage)<div class='desc'>Called for each object or actor when exiting a room.</div><div class='function text'>This function calls <span class='inline_code'>object.exit()</span> then stops any sound playing that is using <span class='inline_code'>object._soundid</span>. </div></div><div id='10' class='function'>_keyDown(key, flags)<div class='desc'>Called when a key goes down.</div><div class='function text'>This function calls <span class='inline_code'>keyDown()</span> and all game related logic should happen in there. The parameter <span class='inline_code'>flags</span> holds the modifier keys such as <span class='inline_code'>MOD_SHIFT</span> and <span class='inline_code'>MOD_CONTROL</span> and can be checked using <div class='line_break'></div> if (flags&MOD_SHIFT) { ... } <div class='line_break'></div> There is no built in functionality for key repeats. </div></div><div id='11' class='function'>_keyUp(key, flags)<div class='desc'>Called when a key comes up.</div><div class='function text'>For most situations you only need to monitor <span class='inline_code'>_keyDown()</span> </div></div><div id='12' class='function'>_actorArrived(actor)<div class='desc'>Called when an actor reaches their final destination.</div><div class='function text'>This function is not called as the actor walks around walkboxes and the actor might not stop close to where they were told to walk. If the room is exited while an actor is walking, they will not get this callback.  This also calls the optional <span class='inline_code'>actor.arrived()</span>. </div></div><div id='13' class='function'>execSentence(actor, verb, noun1, noun2=null)<div class='desc'>Called to execute a sentence and, if needed, start the actor walking.</div><div class='function text'>If <span class='inline_code'>actor</span> is <span class='inline_code'>null</span> then the selectedActor is assumed. If the actor has to walk, the verb code will be called from _actorArrived. </div></div><div id='14' class='function'>cancelSentence(actor)<div class='desc'>Cancels any sentence queued for the actor</div><div class='function text'>If <span class='inline_code'>actor</span> is <span class='inline_code'>null</span> then the selectedActor is assumed. </div></div><div id='15' class='function'>inputOff(code)<div class='desc'>Turns the input off, runs the code, and then back on</div><div class='function text'>The cursor will also turn off during this time.  It should be used for short sequences you don't want the player to interrupt. <div class='code_block'>inputOff(@{
    actorWalkTo(selectedActor, toiletHandle)
    breakwhilewalking(selectedActor)
})
</div></div></div><div id='16' class='function'>cancelAllInteractions()<div class='desc'>Cancels all drags and sentences.</div><div class='function text'></div></div><div id='17' class='function'>_hoverObject(state, object, room_pos)<div class='desc'>Called when an object is hovered over.</div><div class='function text'>The state will be <span class='inline_code'>HOVER_ENTER</span>, <span class='inline_code'>HOVER_LEAVE</span>, or <span class='inline_code'>HOVER_LOITER</span>. The function is responsible for creating the text that appears at the cursor. </div></div><div id='18' class='function'>_clickedDownAt(screen_pos, flags)<div class='desc'>Called when the screen is clicked or touched.</div><div class='function text'>It called on click-down unless it's a touch interface, then it's on touch-up. <div class='line_break'></div> <span class='inline_code'>clickedAt()</span> and <span class='inline_code'>room.clickedAt()</span> are also called by this function. <div class='line_break'></div> If a <span class='inline_code'>button</span> is clicked on, this callback will not happen.  See <a href='gameimage.html'><span class='inline_code'>imageButton()</span></a> for more information about buttons. </div></div><div id='19' class='function'>_clickedUpAt(screen_pos, flags)<div class='desc'>Called when the mouse button is let up.</div><div class='function text'></div></div><div id='20' class='function'>_clickedDragAt(screen_pos, flags)<div class='desc'>Called when the mouse is moved with the button down.</div><div class='function text'></div></div><div id='21' class='function'>_startSayline(actor, text)<div class='desc'>Called when sayLine text needs to be displayed.</div><div class='function text'>Return an image of the text. </div></div><div id='22' class='function'>_doneSayline(actor)<div class='desc'>Called when the actor's sayLine is done.</div><div class='function text'></div></div><div id='26' class='function'>_triggerSound(actor,sound)<div class='desc'>Called when an actor or object animation triggers a sound</div><div class='function text'></div></div><div id='27' class='function'>_pauseGame(state)<div class='desc'>Called when the game is paused by the window going out of focus</div><div class='function text'>Also called after the <span class='inline_code'>pauseGame(YES|NO)</span> is called. This is typically used for a pause key. </div></div><div id='28' class='function'>_gameFocus(state)<div class='desc'>Called when the game gains or looses focus.</div><div class='function text'></div></div><div id='29' class='function'>_quitGame()<div class='desc'>Called when the game wants to quit.</div><div class='function text'>Return <span class='inline_code'>true</span> if it's OK, or <span class='inline_code'>false</span> if the scripts want to avoid the quit or handle it themselves. </div></div></div><p class='copyright'>Copyright 2020 Terrible Toybox, Inc. All Rights Reserved.</p></body></html>